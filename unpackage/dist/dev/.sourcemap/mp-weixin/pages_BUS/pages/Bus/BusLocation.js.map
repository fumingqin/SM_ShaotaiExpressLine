{"version":3,"sources":["uni-app:///main.js","webpack:///D:/UAD/NP_ComprehensiveTravel/pages_BUS/pages/Bus/BusLocation.vue?fd26","webpack:///D:/UAD/NP_ComprehensiveTravel/pages_BUS/pages/Bus/BusLocation.vue?3707","webpack:///D:/UAD/NP_ComprehensiveTravel/pages_BUS/pages/Bus/BusLocation.vue?7d3c","webpack:///D:/UAD/NP_ComprehensiveTravel/pages_BUS/pages/Bus/BusLocation.vue?bb10","uni-app:///pages_BUS/pages/Bus/BusLocation.vue","webpack:///D:/UAD/NP_ComprehensiveTravel/pages_BUS/pages/Bus/BusLocation.vue?e568"],"names":["createPage","Page","renderjs","component","options","__file","components","uPopup","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped"],"mappings":";;;;wEAAA,qBACA,sBACA,wD,mDACAA,EAAWC,a;;;;2DCHX,2RACIC,EADJ,oKASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,sCACZ,aAAAF,E;;;;2GCvBf,0mC;;;;2GCAA,8LAAIG,EAAa,CACfC,OAAQ,WACN,OAAO,yKAKPC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G;;;;2DCdvB,2uBAAorB,eAAG,G;;;;wEC2DvrB,M,sRAEA,CACA,YACA,gBAEA,KAJA,WAKA,OACA,gBACA,cACA,WACA,gBACA,qBACA,oBACA,sBACA,iBACA,UACA,eACA,oBACA,cACA,oBACA,UACA,aACA,WACA,cAGA,OAzBA,SAyBA,GAeA,GAdA,OACA,cACA,+DAGA,sFACA,kBAEA,kBAGA,kBAGA,mDACA,yBACA,oCAEA,sBAEA,iEAEA,mCAEA,2EAEA,qBAEA,gCAEA,CACA,uBAEA,yBACA,gDAEA,yDACA,6CAGA,gCAGA,wBAEA,oBAEA,uBACA,cAEA,SAKA,8BACA,gCACA,8BACA,MAGA,gCACA,6BAGA,0BAEA,gCACA,6BAEA,wBAEA,oBACA,kBACA,iCACA,qBACA,kBACA,iCAIA,oBACA,kBACA,qBACA,6BACA,qBACA,kBACA,qBACA,8BAKA,yBACA,yCACA,oBACA,qBAEA,mBAIA,oBACA,sCAGA,4BACA,8BACA,sCAGA,+BACA,+BACA,UAGA,4BACA,qBAGA,2BACA,mBACA,yBAWA,uCACA,WACA,wDACA,8DACA,MACA,4DACA,sDAEA,QAPA,SAOA,GAEA,GADA,0BACA,cAIA,IAFA,8CAEA,6BAEA,4EAEA,qCAEA,6DAEA,+BAEA,qBAEA,kCAIA,aACA,iBACA,eAIA,KAnCA,SAmCA,GACA,0BAKA,4BACA,eACA,iBAEA,WACA,mEACA,yEACA,MACA,gBACA,0BACA,sDAEA,QARA,SAQA,GAGA,GAFA,gBAEA,eACA,0BAEA,qCACA,8DACA,2BAIA,aACA,iBACA,eAIA,KA1BA,SA0BA,GACA,gBACA,0BAKA,mCACA,WACA,0EACA,gFACA,MACA,gBACA,0BACA,sDAEA,QARA,SAQA,GAEA,kBACA,sCAEA,wDAEA,iBAEA,SACA,OACA,wBAyBA,+BACA,iDAEA,oBACA,aACA,iBACA,eAKA,KAvDA,SAuDA,GACA,gCAKA,+BACA,eACA,iBAEA,WACA,oEACA,0EACA,MACA,gBACA,sBACA,sDAEA,QARA,SAQA,GAGA,GAFA,gBACA,eACA,cACA,sCACA,OACA,kEAEA,yBAGA,aACA,iBACA,eAIA,KAzBA,SAyBA,GACA,gBACA,mBAKA,yBACA,WACA,0CACA,gDACA,MACA,sDAEA,QANA,SAMA,GACA,cACA,6CAEA,aACA,iBACA,eAIA,KAhBA,SAgBA,GACA,kC;;;;2DC/ZA,uxCAAyuC,eAAG,G","file":"pages_BUS/pages/Bus/BusLocation.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages_BUS/pages/Bus/BusLocation.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./BusLocation.vue?vue&type=template&id=2d157bf3&\"\nvar renderjs\nimport script from \"./BusLocation.vue?vue&type=script&lang=js&\"\nexport * from \"./BusLocation.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BusLocation.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages_BUS/pages/Bus/BusLocation.vue\"\nexport default component.exports","export * from \"-!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BusLocation.vue?vue&type=template&id=2d157bf3&\"","var components = {\n  uPopup: function() {\n    return import(\n      /* webpackChunkName: \"uview-ui/components/u-popup/u-popup\" */ \"@/uview-ui/components/u-popup/u-popup.vue\"\n    )\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BusLocation.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BusLocation.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"myView\">\r\n\t\t<!-- 头部显示信息的view -->\r\n\t\t<view class=\"topContentInfo\">\r\n\t\t\t<view class=\"topHead\">\r\n\t\t\t\t<view>\r\n\t\t\t\t\t<view class=\"topStation\">\r\n\t\t\t\t\t\t<view class=\"marginR\" style=\"font-size: 36rpx;\">{{startStation}}</view>\r\n\t\t\t\t\t\t<!-- <view class=\"marginR\">→</view>\r\n\t\t\t\t\t\t<view>{{endStation}}</view> -->\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"topStation topTime\">\r\n\t\t\t\t\t\t<view class=\"marginR\">首 {{firstLastTimeArray[0]}}</view>\r\n\t\t\t\t\t\t<view class=\"marginR\">末 {{firstLastTimeArray[1]}}</view>\r\n\t\t\t\t\t\t<!-- <view style=\"margin-left: 30rpx; color: #FFFFFF; marborder-bottom: 1rpx solid #EEEEEE;white-space: nowrap;width: 300rpx; overflow: hidden;text-overflow: ellipsis;\">票价：{{price}}</view> -->\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<image class=\"turnImage\" src=\"../../static/Bus/turnBusdirection.png\" @click=\"turnImageClick\"></image>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view style=\"margin-top: 20rpx; margin-left: 30rpx; color: #FFFFFF; marborder-bottom: 1rpx solid #EEEEEE;\">票价：{{price}}</view>\r\n\t\t\t<!-- 时刻表弹框 -->\r\n\t\t\t<view class=\"timeClass\">\r\n\t\t\t\t<u-popup v-model=\"isShow\" mode=\"center\" border-radius=\"14\" width=\"600rpx\">\r\n\t\t\t\t\t<view class=\"timeClass_text timeClass_title\">最近发班时刻</view>\r\n\t\t\t\t\t<block v-for=\"(item,index) in timeArray\" :key=\"index\">\r\n\t\t\t\t\t\t<view class=\"timeClass_text timeClass_time\">{{item.foreStartTime}}</view>\r\n\t\t\t\t\t</block>\r\n\t\t\t\t</u-popup>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"timeButton\" @click=\"timeButtonClick\">最近发班时刻</view>\r\n\t\t\t\r\n\t\t\t<!-- 暂时没有数据，先隐藏 -->\r\n\t\t\t<view class=\"topBottom\" v-if=\"false\">\r\n\t\t\t\t<view class=\"topBottomLeft\">\r\n\t\t\t\t\t<view class=\"topBottomText\">下一站/3分600米</view>\r\n\t\t\t\t\t<view class=\"topBottomText\">预计到达</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view style=\"width: 50%;\">\r\n\t\t\t\t\t<view class=\"topBottomText\">10:00</view>\r\n\t\t\t\t\t<view class=\"topBottomText\">预计起点发车</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 时间轴 -->\r\n\t\t<scroll-view scroll-x=\"true\" class=\"busTimeStep\">\r\n\t\t\t<BusTimeSteps :list=\"stationList\" :current=\"stationInfoArray.ChangStation\" :direction=\"direction\" :carLocationArray=\"carLocationArray\"></BusTimeSteps>\r\n\t\t</scroll-view>\r\n\t\t\r\n\t\t<view class=\"bottomView\">\r\n\t\t\t<!-- <view @click=\"getBusLocationOntime\">公交实时位置</view> -->\r\n\t\t\t<view style=\"width: 100%;\" @click=\"turnDirection\">横竖转换</view>\r\n\t\t</view>\r\n\t\t\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tvar _self;\r\n\timport BusTimeSteps from '../../commponents/BUS/BUS.vue';\r\n\texport default {\r\n\t\tcomponents:{\r\n\t\t\tBusTimeSteps\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tstartStation:'',\r\n\t\t\t\tendStation:'',\r\n\t\t\t\tprice:'1元',\r\n\t\t\t\tdirection:'row',//默认横向排列\r\n\t\t\t\tisClickTurnButton:false,\r\n\t\t\t\tstationInfoArray:[],//接收上一个页面传过来的数据\r\n\t\t\t\tfirstLastTimeArray:[],//时间\r\n\t\t\t\tlineDirection:'',//公交上下行方向0:上行 1:下行\r\n\t\t\t\tlineID:'',//线路ID\r\n\t\t\t\tstationList:[],//站点数组\r\n\t\t\t\tcarLocationArray:[],//车辆位置数组\r\n\t\t\t\tserverTime:'',//服务器时间\r\n\t\t\t\tmarkStationIndex:'',//选择的站点的下标\r\n\t\t\t\tisShow:false,//是否显示弹框\r\n\t\t\t\ttimeArray:[],//发班时间表数组\r\n\t\t\t\ttimer:null,\r\n\t\t\t\tlastPage:'',//记录上一个页面是从哪里进来的\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(option) {\r\n\t\t\t_self = this;\r\n\t\t\t_self.lastPage = '';\r\n\t\t\t_self.stationInfoArray = JSON.parse(decodeURIComponent(option.lineRoute));\r\n\t\t\t// console.log(_self.stationInfoArray)\r\n\t\t\t//从上个页面获取该条线路是上行还是下行\r\n\t\t\tif(_self.stationInfoArray.LineRouteDirection == '上行' || _self.stationInfoArray.LineRouteDirection == 0){\r\n\t\t\t\t_self.lineDirection = 0;\r\n\t\t\t}else {\r\n\t\t\t\t_self.lineDirection = 1;\r\n\t\t\t};\r\n\t\t\t//获取服务器时间\r\n\t\t\t_self.getServerTime();\r\n\t\t\t//如果上一个页面是从SearchDetail或者BusQuery跳转过来的，因为里面有时间跟线路ID所以不用请求getBusLineInfoByStationName接口，直接赋值\r\n\t\t\t//如果是从搜索页、搜索详情页、首页进来的话有传线路ID，就不需要再去请求getBusLineInfoByStationName接口\r\n\t\t\tif(option.lastPage == 'SearchDetail' || option.lastPage == 'BusQuery'){\r\n\t\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\t\ttitle:_self.stationInfoArray.lineName\r\n\t\t\t\t})\r\n\t\t\t\t_self.lastPage = 'BusQuery';\r\n\t\t\t\t//取到时间，转成数组\r\n\t\t\t\t_self.firstLastTimeArray = _self.stationInfoArray.firstLastTime.split('-');\r\n\t\t\t\t//取出线路ID\r\n\t\t\t\t_self.lineID = _self.stationInfoArray.lineID;\r\n\t\t\t\t//获取显示的站点名称（起点-终点）\r\n\t\t\t\t_self.startStation = _self.stationInfoArray.StartName + '→' + _self.stationInfoArray.EndName;\r\n\t\t\t\t//请求：根据线路查询改线路的所有站点信息，这个接口需要用到线路ID，线路方向\r\n\t\t\t\t_self.getStationByLine();\r\n\t\t\t\t//请求：根据线路查询车辆实时位置信息，这个接口需要用到线路ID，线路方向\r\n\t\t\t\t_self.getBusLocationByStation();\r\n\t\t\t\t\r\n\t\t\t}else {\r\n\t\t\t\t_self.lastPage = 'RoutePlan';\r\n\t\t\t\t//设置导航栏标题为线路名称\r\n\t\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\t\ttitle: _self.getLine(_self.stationInfoArray.LineRoute)\r\n\t\t\t\t})\r\n\t\t\t\tvar station = _self.getStartEndStation(_self.stationInfoArray.LineRoute)\r\n\t\t\t\t_self.startStation = station[0].substring(1,station[0].length)\r\n\t\t\t\t//如果上一个页面是从RoutePlan页面进来的需要先去获取时间跟线路ID\r\n\t\t\t\t//根据站点查询线路信息（时间、线路ID）\r\n\t\t\t\t_self.getBusLineInfoByStationName();\r\n\t\t\t}\r\n\t\t\t//设置定时器，每十秒刷新一次公交位置信息\r\n\t\t\t_self.setBusTimeInterval();\r\n\t\t},\r\n\t\tonUnload:function(){\r\n\t\t\t//清楚定时器\r\n\t\t\tclearInterval(_self.timer);\r\n\t\t\t_self.timer = null;\r\n\t\t},\r\n\t\tmethods: {\r\n//-------------------------------------------功能方法模块开始-------------------------------------------\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t//-------------------------------------------设置定时器，10秒获取一次公交位置信息-------------------------------------------\r\n\t\t\tsetBusTimeInterval:function(){\r\n\t\t\t\t_self.timer = setInterval(()=>{\r\n\t\t\t\t\t_self.getBusLocationByStation();\r\n\t\t\t\t},10000)\r\n\t\t\t},\r\n\t\t\t//-------------------------------------------获取车辆实时位置-------------------------------------------\r\n\t\t\tgetBusLocationOntime:function(){\r\n\t\t\t\t_self.getBusLocationByStation();\r\n\t\t\t},\r\n\t\t\t//-------------------------------------------调换公交行驶方向-------------------------------------------\r\n\t\t\tturnImageClick:function(){\r\n\t\t\t\t//更换显示的站点名称,调换起点跟终点的位置\r\n\t\t\t\tvar stationArray = _self.startStation.split('→')\r\n\t\t\t\t_self.startStation = stationArray[1] + '→' + stationArray[0]\r\n\t\t\t\t\r\n\t\t\t\tif(_self.lastPage == 'RoutePlan'){\r\n\t\t\t\t\t//更换线路方向\r\n\t\t\t\t\tif(_self.lineDirection == 0){\r\n\t\t\t\t\t\t_self.lineDirection = 1;\r\n\t\t\t\t\t\t_self.getBusLineInfoByStationName();\r\n\t\t\t\t\t}else if (_self.lineDirection == 1){\r\n\t\t\t\t\t\t_self.lineDirection = 0;\r\n\t\t\t\t\t\t_self.getBusLineInfoByStationName();\r\n\t\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\t\t//更换线路方向\r\n\t\t\t\t\tif(_self.lineDirection == 0){\r\n\t\t\t\t\t\t_self.lineDirection = 1;\r\n\t\t\t\t\t\t_self.getStationByLine();\r\n\t\t\t\t\t\t_self.getBusLocationByStation();\r\n\t\t\t\t\t}else if (_self.lineDirection == 1){\r\n\t\t\t\t\t\t_self.lineDirection = 0;\r\n\t\t\t\t\t\t_self.getStationByLine();\r\n\t\t\t\t\t\t_self.getBusLocationByStation();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//-------------------------------------------调换线路显示的方向-------------------------------------------\r\n\t\t\tturnDirection:function(){\r\n\t\t\t\t_self.isClickTurnButton = !_self.isClickTurnButton;\r\n\t\t\t\tif(_self.isClickTurnButton) {\r\n\t\t\t\t\t_self.direction = 'column'\r\n\t\t\t\t}else {\r\n\t\t\t\t\t_self.direction = 'row'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//-------------------------------------------截取线路名称-------------------------------------------\r\n\t\t\tgetLine:function(lineRoute){\r\n\t\t\t\treturn lineRoute.substring(0,lineRoute.indexOf('('));\r\n\t\t\t},\r\n\t\t\t//-------------------------------------------截取站点名称-------------------------------------------\r\n\t\t\tgetStartStation:function(lineRoute){\r\n\t\t\t\tvar subStr = lineRoute.match(/(\\(\\S*)(?=→)/)\r\n\t\t\t\treturn subStr[1].substring(1,subStr[1].length)\r\n\t\t\t},\r\n\t\t\t//-------------------------------------------截取首站和末站名称-------------------------------------------\r\n\t\t\tgetStartEndStation:function(lineRoute){\r\n\t\t\t\tvar subStr = lineRoute.match(/(\\(\\S*)(?=\\))/)\r\n\t\t\t\treturn subStr\r\n\t\t\t},\r\n\t\t\t//-------------------------------------------截取时间-------------------------------------------\r\n\t\t\tgetScheduleTime:function(date){\r\n\t\t\t\treturn date.split(' ')\r\n\t\t\t},\r\n\t\t\t//-------------------------------------------点击时刻表-------------------------------------------\r\n\t\t\ttimeButtonClick:function(){\r\n\t\t\t\t_self.isShow = !_self.isShow;\r\n\t\t\t\t_self.getTimeScheduleInfo();\r\n\t\t\t},\r\n//-------------------------------------------功能方法模块结束-------------------------------------------\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n//-------------------------------------------请求方法模块开始-------------------------------------------\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t//----------------------------------根据站点查询线路信息（时间、线路ID）----------------------------------\r\n\t\t\tgetBusLineInfoByStationName:function(){\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl:_self.$Bus.BusInterface.getBusLineInfoByStationName.Url,\r\n\t\t\t\t\tmethod:_self.$Bus.BusInterface.getBusLineInfoByStationName.method,\r\n\t\t\t\t\tdata:{\r\n\t\t\t\t\t\tstationName :  _self.getStartStation(_self.stationInfoArray.LineRoute),\r\n\t\t\t\t\t\tEncryption  :  _self.$Bus.BusInterface.publicCode.encryption\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tconsole.log('请求线路信息成功',res)\r\n\t\t\t\t\t\tif(res.data.status){\r\n\t\t\t\t\t\t\t//截取出线路方案的站点名称\r\n\t\t\t\t\t\t\tvar stationName = _self.getLine(_self.stationInfoArray.LineRoute)\r\n\t\t\t\t\t\t\t//遍历数组，取出与当前站点相对应的时间\r\n\t\t\t\t\t\t\tfor(var i = 0; i < res.data.data.length; i++) {\r\n\t\t\t\t\t\t\t\t//取出线路名称相同且线路方向一致的数据\r\n\t\t\t\t\t\t\t\tif(stationName == res.data.data[i].lineName && _self.lineDirection == res.data.data[i].lineDirection){\r\n\t\t\t\t\t\t\t\t\t//取出区间价格\r\n\t\t\t\t\t\t\t\t\t_self.price = res.data.data[i].PriceDescribe\r\n\t\t\t\t\t\t\t\t\t//取到时间，转成数组\r\n\t\t\t\t\t\t\t\t\t_self.firstLastTimeArray = res.data.data[i].firstLastTime.split('-')\r\n\t\t\t\t\t\t\t\t\t//取出线路ID\r\n\t\t\t\t\t\t\t\t\t_self.lineID = res.data.data[i].lineID\r\n\t\t\t\t\t\t\t\t\t//请求：根据线路查询改线路的所有站点信息，这个接口需要用到线路ID，线路方向\r\n\t\t\t\t\t\t\t\t\t_self.getStationByLine();\r\n\t\t\t\t\t\t\t\t\t//请求：根据线路查询车辆实时位置信息，这个接口需要用到线路ID，线路方向\r\n\t\t\t\t\t\t\t\t\t_self.getBusLocationByStation();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle:res.data.msg,\r\n\t\t\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\tconsole.log('请求失败',res)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//----------------------------------根据线路查询该线路的所有站点信息----------------------------------\r\n\t\t\tgetStationByLine:function(){\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle:'加载中...'\r\n\t\t\t\t})\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: _self.$Bus.BusInterface.getBusLineStationInfoByLineIdDirection.Url,\r\n\t\t\t\t\tmethod: _self.$Bus.BusInterface.getBusLineStationInfoByLineIdDirection.method,\r\n\t\t\t\t\tdata:{\r\n\t\t\t\t\t\tlineId     : _self.lineID,\r\n\t\t\t\t\t\tdirection  : _self.lineDirection,\r\n\t\t\t\t\t\tEncryption : _self.$Bus.BusInterface.publicCode.encryption\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t// console.log('站点信息',res)\r\n\t\t\t\t\t\tif(res.data.status){\r\n\t\t\t\t\t\t\t_self.stationList = res.data.data\r\n\t\t\t\t\t\t\t//筛选出目标站点的下标，要让目标站点滚动到屏幕中心\r\n\t\t\t\t\t\t\tfor(var i = 0; i < res.data.data.length; i++){\r\n\t\t\t\t\t\t\t\tif(_self.stationInfoArray.ChangStation == res.data.data[i].stationName){\r\n\t\t\t\t\t\t\t\t\t_self.markStationIndex = i;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle:res.data.msg,\r\n\t\t\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\tconsole.log('请求失败',res)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//----------------------------------根据线路编号和运行方向获取某条线路即将到站的车辆信息----------------------------------\r\n\t\t\tgetBusLocationByStation:function(){\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: _self.$Bus.BusInterface.getBusArriveLeaveStationInfoByLineIdDirection.Url,\r\n\t\t\t\t\tmethod: _self.$Bus.BusInterface.getBusArriveLeaveStationInfoByLineIdDirection.method,\r\n\t\t\t\t\tdata:{\r\n\t\t\t\t\t\tlineId      : _self.lineID,\r\n\t\t\t\t\t\tdirection   : _self.lineDirection,\r\n\t\t\t\t\t\tEncryption  : _self.$Bus.BusInterface.publicCode.encryption\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t// console.log('请求实时到站信息成功',res)\r\n\t\t\t\t\t\tif(res.data.status){\r\n\t\t\t\t\t\t\tfor(var i = 0; i < res.data.data.length; i++){\r\n\t\t\t\t\t\t\t\t//车辆时时到站时间戳\r\n\t\t\t\t\t\t\t\tvar arriveTime = new Date(res.data.data[i].generationTime).getTime()\r\n\t\t\t\t\t\t\t\t//用服务器时间戳减去车辆到站的时间戳\r\n\t\t\t\t\t\t\t\tvar date = _self.serverTime - arriveTime\r\n\t\t\t\t\t\t\t\t//得到的时间差是分钟（车辆到站与服务器的时间差），如果时间超过30分钟就不显示\r\n\t\t\t\t\t\t\t\tvar miun = date / (60*60)\r\n\t\t\t\t\t\t\t\tif(miun >= 30){\r\n\t\t\t\t\t\t\t\t\tres.data.data.splice(i,1)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t//这里的方法不需要，不要管\r\n\t\t\t\t\t\t\t// var array = [];\r\n\t\t\t\t\t\t\t// for(var i = 0; i < res.data.data.length; i++){\r\n\t\t\t\t\t\t\t// \tfor(var j = 0; j < _self.stationList.length; j++){\r\n\t\t\t\t\t\t\t// \t\tif(res.data.data[i].stationIndex == j){\r\n\t\t\t\t\t\t\t// \t\t\tvar item = {\r\n\t\t\t\t\t\t\t// \t\t\t\t\"lineID\": _self.stationList[j-1].lineID,\r\n\t\t\t\t\t\t\t// \t\t\t\t\"stationID\": _self.stationList[j-1].stationID,\r\n\t\t\t\t\t\t\t// \t\t\t\t\"stationName\": _self.stationList[j-1].stationName,\r\n\t\t\t\t\t\t\t// \t\t\t\t\"direction\": _self.stationList[j-1].direction,\r\n\t\t\t\t\t\t\t// \t\t\t\t\"stationIndex\": _self.stationList[j-1].stationIndex,\r\n\t\t\t\t\t\t\t// \t\t\t\t\"lon\": _self.stationList[j-1].lon,\r\n\t\t\t\t\t\t\t// \t\t\t\t\"lat\": _self.stationList[j-1].lat,\r\n\t\t\t\t\t\t\t// \t\t\t\t\"carIndex\" : res.data.data[i].stationIndex\r\n\t\t\t\t\t\t\t// \t\t\t}\r\n\t\t\t\t\t\t\t// \t\t\t_self.stationList.splice(j-1,1)\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// \t\t\t_self.stationList.splice(j-1,1,item)\r\n\t\t\t\t\t\t\t// \t\t}\r\n\t\t\t\t\t\t\t// \t}\r\n\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t_self.carLocationArray = res.data.data\r\n\t\t\t\t\t\t\tconsole.log('请求实时到站信息成功',_self.carLocationArray)\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tif(res.data.msg != \"无数据！\"){\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle:res.data.msg,\r\n\t\t\t\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\tconsole.log('请求实时到站信息失败',res)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//----------------------------------获取最近发班时刻表----------------------------------\r\n\t\t\tgetTimeScheduleInfo:function(){\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle:'加载中...'\r\n\t\t\t\t})\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl:_self.$Bus.BusInterface.getBusLineScheduleInfoByLineIdDirection.Url,\r\n\t\t\t\t\tmethod:_self.$Bus.BusInterface.getBusLineScheduleInfoByLineIdDirection.method,\r\n\t\t\t\t\tdata:{\r\n\t\t\t\t\t\tlineId    : _self.lineID,\r\n\t\t\t\t\t\tdirection : _self.direction,\r\n\t\t\t\t\t\tEncryption: _self.$Bus.BusInterface.publicCode.encryption\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t_self.timeArray = [];\r\n\t\t\t\t\t\tif(res.data.status){\r\n\t\t\t\t\t\t\tfor(var i = 0; i < res.data.data.length; i++){\r\n\t\t\t\t\t\t\t\tvar timeArray = {\r\n\t\t\t\t\t\t\t\t\tforeStartTime : _self.getScheduleTime(res.data.data[i].foreStartTime)[1]\r\n\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t_self.timeArray.push(timeArray)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle:res.data.msg,\r\n\t\t\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//----------------------------------获取服务器时间----------------------------------\r\n\t\t\tgetServerTime:function(){\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: _self.$Bus.BusInterface.getServerTime.Url,\r\n\t\t\t\t\tmethod: _self.$Bus.BusInterface.getServerTime.method,\r\n\t\t\t\t\tdata:{\r\n\t\t\t\t\t\tEncryption  : _self.$Bus.BusInterface.publicCode.encryption\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tif(res.data.status){\r\n\t\t\t\t\t\t\t_self.serverTime = new Date(res.data.data).getTime()\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle:res.data.msg,\r\n\t\t\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\tconsole.log('请求实时到站信息失败',res)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t\r\n//-------------------------------------------请求方法模块结束-------------------------------------------\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t$u-itemtMarginLeft:20rpx;\r\n\t$u-contentMarginLeft:30rpx;\r\n\tpage,\r\n\t.myView {\r\n\t\tflex-direction: column;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tbackground: #F1F1F1;\r\n\t}\r\n\t\r\n\t.topContentInfo{\r\n\t\tpadding-top: 30rpx;\r\n\t\tpadding-bottom: 30rpx;\r\n\t\tmargin-top: 20rpx;\r\n\t\tmargin-left: $u-itemtMarginLeft;\r\n\t\tmargin-right: $u-itemtMarginLeft;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbackground-color: #35C762;\r\n\t}\r\n\t.topHead {\r\n\t\tmargin-left: $u-contentMarginLeft;\r\n\t\tmargin-right: $u-contentMarginLeft;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tborder-bottom: 1rpx solid #EEEEEE;\r\n\t}\r\n\t.topStation{\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tcolor: #FFFFFF;\r\n\t\tfont-size: 30rpx;\r\n\t}\r\n\t.topTime{\r\n\t\tmargin-top: 20rpx;\r\n\t\tfont-size: 26rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\t.marginR {\r\n\t\tmargin-right: 20rpx;\r\n\t}\r\n\t.turnImage{\r\n\t\theight: 43rpx;\r\n\t\twidth: 52rpx;\r\n\t\tmargin-right: 40rpx;\r\n\t}\r\n\t.timeClass{\r\n\t\ttext-align: center;;\r\n\t\t.timeClass_text{\r\n\t\t\tjustify-content: center;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\t\t.timeClass_title{\r\n\t\t\theight: 80rpx;\r\n\t\t\tfont-size: 36rpx;\r\n\t\t\tfont-weight: 900;\r\n\t\t}\r\n\t\t.timeClass_time{\r\n\t\t\theight: 60rpx;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t\tfont-weight: 300;\r\n\t\t}\r\n\t}\r\n\t.timeButton{\r\n\t\tmargin-left: $u-contentMarginLeft;\r\n\t\tmargin-top: $u-contentMarginLeft;\r\n\t\tfont-size: 30rpx;\r\n\t\tfont-weight: 600;\r\n\t\twidth: 210rpx;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 5rpx 10rpx;\r\n\t\tcolor: #FFFFFF;\r\n\t\tborder: 1rpx solid #FFFFFF;\r\n\t}\r\n\t.topBottom{\r\n\t\tmargin-left: $u-contentMarginLeft;\r\n\t\tmargin-right: $u-contentMarginLeft;\r\n\t\tmargin-top: 30rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\t.topBottomLeft{\r\n\t\twidth: 50%;\r\n\t\tborder-right: 1rpx solid #FFFFFF;\r\n\t}\r\n\t.topBottomText{\r\n\t\ttext-align: center;\r\n\t\tcolor: #FFFFFF;\r\n\t\tfont-size: 28rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t.busTimeStep{\r\n\t\tmargin-top: 20rpx;\r\n\t\tmargin-left: $u-itemtMarginLeft;\r\n\t\tmargin-right: $u-itemtMarginLeft;\r\n\t\twidth: 710rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\t// padding-top: 50rpx;\r\n\t}\r\n\t.bottomView{\r\n\t\tposition: fixed;\r\n\t\tbottom: 0;\r\n\t\theight: 100rpx;\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\ttext-align: center;\r\n\t}\r\n\t.bottomView>view:first-child{\r\n\t\twidth: 50%;\r\n\t\tfont-size: 30rpx;\r\n\t}\r\n\t.bottomView>view:last-child{\r\n\t\twidth: 50%;\r\n\t\tfont-size: 30rpx;\r\n\t}\r\n</style>\r\n","import mod from \"-!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BusLocation.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BusLocation.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}